/**
 * Zero-Knowledge Protocols for E-Vote (ZKPEV).
 *
 * Copyright Â© 2013, The Norwegian Ministry of Local Government and Regional
 * Development (KRD).
 *
 * This file is part of ZKPEV.
 *
 * ZKPEV is free software: you can redistribute it and/or modify it under the
 * terms of the GNU General Public License as published by the Free Software
 * Foundation, either version 3 of the License, or (at your option) any later
 * version.
 *
 * ZKPEV is distributed in the hope that it will be useful, but WITHOUT ANY
 * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more
 * details.
 *
 * You can find a copy of the GNU General Public License in
 * /src/site/resources/gpl-3.0-standalone.html. Otherwise, see also
 * http://www.gnu.org/licenses/.
 */
package com.computas.zkpev2013;

import static org.testng.Assert.assertEquals;
import static org.testng.Assert.assertNotNull;

import org.testng.annotations.BeforeMethod;
import org.testng.annotations.Test;

import java.io.IOException;
import java.io.UnsupportedEncodingException;

import java.math.BigInteger;

import java.security.NoSuchAlgorithmException;

import java.util.Arrays;


/**
 * Unit tests against the EncryptedVote class.
 */
public class EncryptedVoteUnitTest {
    private static final String COMMA = ",";
    private static final Object GIVEN_CONTEST_ID = "000018";
    private static final Object GIVEN_ELECTION_ID = "01";
    private static final Object GIVEN_ELECTION_EVENT_ID = "730071";
    private static final String GIVEN_UUID = "8a84806e40521c6d014052329b3401ed";
    private static final String GIVEN_AUTH_TOKEN = "rO0ABXNyADtjb20uc2N5dGwuZXZvdGUucHJvdG9jb2wuaW50ZWdyYXRpb24udm90aW5nLm1vZGVsLkF1dGhUb2tlbvz+Wz5pky7LAgAWSQAhX2FkdmFuY2VPZkV4cGlyYXRpb25UaW1lSW5NaW51dGVzSQAaX2FmdGVyQ2xvc2luZ1RpbWVJblNlY29uZHNKAAVfYXNJZEkAGF9leHBpcmF0aW9uVGltZUluTWludXRlc0oAA190c1sAD19hdXRoU2VydmljZVNpZ3QAAltCTAAJX2NvbnRlc3RzdAAQTGphdmEvdXRpbC9MaXN0O0wAGl9jb250cm9sbGVkUmV0dXJuY29kZXNUeXBldAASTGphdmEvbGFuZy9TdHJpbmc7TAAQX2VsZWN0aW9uRXZlbnRJZHEAfgADTAALX2VsZWN0aW9uSWRxAH4AA0wAA19pZHEAfgADTAAJX2ludFRva2VudABBTGNvbS9zY3l0bC9ldm90ZS9wcm90b2NvbC9pbnRlZ3JhdGlvbi92b3RpbmcvbW9kZWwvSW50ZXJuYWxUb2tlbjtMABdfaW50VG9rZW5FbnRpdHlQcm92aWRlcnEAfgADTAADX2lwcQB+AANMAA1fcG9sbGluZ1BsYWNldABATGNvbS9zY3l0bC9ldm90ZS9wcm90b2NvbC9pbnRlZ3JhdGlvbi92b3RpbmcvbW9kZWwvUG9sbGluZ1BsYWNlO0wAHF91bmNvbnRyb2xsZWRSZXR1cm5jb2Rlc1R5cGVxAH4AA0wACl92b3RlckFyZWFxAH4AA0wADF92b3RlckNvbW1JZHEAfgADTAAPX3ZvdGVyRmlyc3ROYW1lcQB+AANMABBfdm90ZXJJZGVudGlmaWVydABDTGNvbS9zY3l0bC9ldm90ZS9wcm90b2NvbC9pbnRlZ3JhdGlvbi92b3RpbmcvbW9kZWwvVm90ZXJJZGVudGlmaWVyO0wADl92b3Rlckxhc3ROYW1lcQB+AANMAAxfdm90aW5nTW9kZXNxAH4AAnhwAAAABQAAAlgAAAAAAAAIAAAAAB4AAAFAUjJdWXVyAAJbQqzzF/gGCFTgAgAAeHAAAAEAkiHd/dQKfImbVY7Yq5Sfbw5qNsYwffE0FJRcycaOAte4A2eu0GhYFs/LRzcp5FsX4dV/wmIRuItJlkUIsvz2CKD95kut6P3+OUbGfdSJWv1olkvvdds3WicfpvlXTp081eiAv2lPjsqZPTz3Ebuce7c+nO09PEWCZRI6KcG0Iw5DisP71OEUuoTBxzP56bVI8Sq2/d/G7WMLFaFWRyw9QwDTvdOwW/iTZ6FJ7bGFkqH51rcDfrvl/8SgybUlQwHg1Hx6tw2P32ZDREvkPidQW9BlvBp8NXc0UbUTGt16d1+aHdw/7E1UtVmaqgkcIEC/aZn95lSP4ueoKF2wPqR17XNyABNqYXZhLnV0aWwuQXJyYXlMaXN0eIHSHZnHYZ0DAAFJAARzaXpleHAAAAABdwQAAAABc3IAQGNvbS5zY3l0bC5ldm90ZS5wcm90b2NvbC5pbnRlZ3JhdGlvbi52b3RpbmcubW9kZWwuQWxsb3dlZENvbnRlc3QiWqLrfd15KQIAA0wACl9jb250ZXN0SWRxAH4AA0wAC19lbGVjdGlvbklkcQB+AANMAAZfdm90ZWRxAH4AA3hwdAAGMDAwMDE4dAACMDF0AAEweHQABlNDUkVFTnQABjczMDA3MXQAA2lkNXQAJDMyNzc1NGMzLWFjNWQtNDRiYS04NDEzLWRjMjljMGYzNmI0MnNyADxjb20uc2N5dGwuZXZvdGUucHJvdG9jb2wuaW50ZWdyYXRpb24udm90aW5nLm1vZGVsLk1pbklEVG9rZW7g1pITYjnPpQIABEoAA190c0wAA19pZHEAfgADTAAFX2luZm9xAH4AA0wACF92b3RlcklkcQB+AAN4cAAAAUBSMly1dAAkNTZlMGFmNDMtMTFjNS00OTljLWFiMWItODBhZWE1OTFhOWNkdABrI1R1ZSBBdWcgMDYgMDc6NTY6MDYgQ0VTVCAyMDEzCnVzZXJJZD0wMTAyNDEzMjk5MAp0cz0xMzc1NzY4NTY2OTY1CmlkPTU2ZTBhZjQzLTExYzUtNDk5Yy1hYjFiLTgwYWVhNTkxYTljZAp0AAswMTAyNDEzMjk5MHQADFVTRVJQQVNTV09SRHQACzEwLjAuMzIuMjQzc3IAPmNvbS5zY3l0bC5ldm90ZS5wcm90b2NvbC5pbnRlZ3JhdGlvbi52b3RpbmcubW9kZWwuUG9sbGluZ1BsYWNl1/fPlAehz24CAAdMAA1fYWRkcmVzc0xpbmUxcQB+AANMAA1fYWRkcmVzc0xpbmUycQB+AANMAA1fYWRkcmVzc0xpbmUzcQB+AANMAAVfbmFtZXEAfgADTAANX29wZW5pbmdIb3Vyc3EAfgACTAAJX3Bvc3RUb3ducQB+AANMAAtfcG9zdGFsQ29kZXEAfgADeHBwcHBwc3EAfgAKAAAAAHcEAAAAAHhwcHEAfgARdAAdNzMwMDcxLjQ3LjE4LjE4MjQuMTgyNDAwLjAwMDV0AAVmYWxzZXQAB1JhZ25hcnJzcgBBY29tLnNjeXRsLmV2b3RlLnByb3RvY29sLmludGVncmF0aW9uLnZvdGluZy5tb2RlbC5Wb3RlcklkZW50aWZpZXLKvqZX4QyCdgIAAkwACF9zcGFyZUlkcQB+AANMAAhfdm90ZXJJZHEAfgADeHB0AAswMTAyNDEzMjk5MHQACzAxMDI0MTMyOTkwdAARTG9cdTAwRjBiclx1MDBGM2tzcQB+AAoAAAABdwQAAAABc3IARGNvbS5zY3l0bC5ldm90ZS5wcm90b2NvbC5pbnRlZ3JhdGlvbi52b3RpbmcubW9kZWwuRWxlY3Rpb25Wb3RpbmdNb2RllMcp1WIDaxECAAJMAAtfZWxlY3Rpb25JZHEAfgADTAALX3ZvdGluZ01vZGVxAH4AA3hwdAACMDF0AAEyeA==";
    private static final String GIVEN_VOTE_Z_K_PROOF_SIG = "NTc5OTI3ODI5Mzk3MjY3Mzg2NDg5MTMxMDA5MTc1MDA5MzY3MjA5NTkzNDg5NTU2NTEzODc0MzY5MzI3OTkxNzU2MDEzNjU4MjU4NTZ8NTM1OTAwNTIwNDA4NjY4MzUyNjQyNjM2Mzc5ODAyMjMxNDEwMjQ3NDc3NzAyMDgwNzk1NjM3ODUwMTI3NTUzOTE5NjA1MDYyOTExODgzMDg4NDI2NDU0NDE4ODcyODQ3NTE3NjUzMzMwNDQ2OTcxMjc1ODAyNTc3MDc3NTA2MzQ5NjExNzA5Nzg4MDU1OTYxNzA5MzE0NzA1Mjk0NjAwMzY2MzI1MDcwMzE1OTkxNjcwODExODI3NjI1NjUyNzI5NzUzNDQ4MTA2ODMyMjkwMDk4ODM1OTQ4NjgyMTgxOTk0ODUwNzc2NzA1MDY3MjUzOTA2MzUzNjQ0MjAyNzEwOTMyMjUwODY0MTg5MTQyOTI4ODEzMjMxNTQ5MzUwMDM5ODU4ODkxMjU2NjQ2MjE5ODUzNDI0MDAwMjQ5NjUyNTAwOTI4MDY1NzE2MDQ2MjkxNjM0MjY5NzUwMzI5NjgxNzI3Mzc5Mzk5MjYyMjIyNzc2ODg4MjQxNDA5ODIwMDc1MjE3MzE4ODk0NjQyNzg2NDI3NjYwNzU0NjE3OTQ5NTk3NDIzNjA2MjkzNzQyMTI2MzAyODk5MjU4MDA4NjYwNzg2NTcwOTcxNzI1NzIxMDkxMDM5Mzg2MTkwMzk4NjkxOTM0MDMzNzQzODY0NzI1MDY0Nzc5NDM4NTQ5NzMwMTMzOTQxNzE5NTA0MzU2OTgzMTA4NjA5MjEyMzE3NDY0MTEyOTg0NTM2OTcxNDAzODEyMDI1MTk5OTE5NTI3MDQ0Mzk5NTY0MTMzNjI2NTIyOTAyMzM5ODgxMDkwOTA0NTQ1OTE4NDQ2NHxudWxs";
    private static final String VOTER_AREA_ID = "730071.47.18.1824.182400.0005";
    private static final String GIVEN_SAMPLE_LINE = GIVEN_UUID + COMMA +
        GIVEN_AUTH_TOKEN + COMMA +
        "327754c3-ac5d-44ba-8413-dc29c0f36b42,IWvRkimscLc7ZnzHRhq5HkKtL0XXlMwZEFu2w7iIdSBCWDAKuxgUNPkA66dqZ7Oy#n#uvqePFoXVHLgemivhxRHAtkKALAtdc3ihfDN99u3vrfiPinPLHcidemy056uxPO+#n#9mb96Cs4RVhFDY3DnW6BuZQUuITmrBOEhaaxja7qbijKD7SNX2bwqRv0j4GeasLa#n#GosqDfFqEYd9aLr7x7M6xkk4AhyoPHG7qAI/A1SiwDxF2ocycQgJk7kl4yeJDgBK#n#PFw0F3xZ1f8yVJEr6d8Su8OwdXN/NiFlX9bjKifFK2bgMqJvlsAPXLjK5ms/2VeS#n#IE4atuMnZquzJMpjEICHcQ==#BuuEgmh0HZdfhNAaD+pVdg8Kgw/lAvU8Bq/07J6ooFz+QzD2uuhexGlqkRCUIq2s#n#bEwYzTLLy+QS+ZeBK5t4k7Gq/wOg85/VLvFcW7wi2sWO5o9HR9k11lX8rW0WxCIn#n#vFzYsZNwWbPiHc7hNswodqTJsIkNpdxWajO8nEMsn4jbSmvcSI1XNTd6mKANuNSJ#n#PUYsyEoUSmEPO8VB29mvEcG4O/EhGLBaEFqLQCFn3Da0NoxO20BiR7D99jHz1M70#n#YeP459wziI94UpetuwTaUKW+Pw8qifwyU/AH8r1Th/MGWncvriPNnEx3Sv6GOeUr#n#t/ImHHGmlYoPrvbGKGQUxw==#AIXBRFx299j0+knJHeC61pJUdJc9RD9teNfo9vAtQh+cMEp7OvGbp3Y2M7tlSklS#n#ovAP3TVjltlqfwteGJXqP/r/eTWCCPmivypjQ7FeOAFTtjrjVa2SMRaAEEaNxq7h#n#/xE1KE9lto+XXZ/NB69m035763kQQemFHIuDeNoDNu0sVpkgtkViJzWGu2b0ZCy2#n#2Sxf69qTntXCMv68tlQWNmFx889DSRpOhDXV3ivkV28J1GfO6sjS5MIWM3a7CZFC#n#NPTf30f4/IZCrnepKjGINxTn/18TWLt3jFYC/jM7I0bLTGVUs8hweC36F9nMKR32#n#dOn65AizJOtKzaYn4cmTxw4=#RLHu2eykn2di6LrMPG/ov+pR/hkx1THELRV5RYPOexiGHjKecIJCe83tskFZFeCr#n#vFWPjgNlQxl1L4GkHICSQ7rJ9rpj9rOSQvGgjm2WqRMO329FmWUCu/MQFQP3u5EO#n#27WUNxeVB9gRufDTtd4f+SZ+nDkW4D/k8GsaJ/GaNTLSgAH7WMuj0H7AVsvHB0y6#n#abJUu8QFZkewmW9RC+Bw2NKimXdlHu9TbhuG3ZuPeXK2ccWpt5HVwRVgYI+/d+p7#n#Gbhl+f1CAh3rWTaAhrsl2ExLav/IrAiXLOrcmEQtnAFq4aXVZP+YwQmfW0NHmkow#n#9H03qfEhPX6f8UH3o6lEmw==#AIJrTHjlP6vjvMaEwkxdYlX7TYgV5WsTqBax91Vt6trRnHs2j+hZE29anlIS3VRE#n#+epvUA5j3WX8i0KEdX/+bi7AF3lYowuHtWGPvNq8CL9Pt8RnteomIqObNx9dglX7#n#7Ic5q4FawXA0dSEpTlZS9YxFSq7sduycaF+h5cfofV5nvYFxapv7k4hJG2XEEZIy#n#ZsCR3AmxVybfnrKDG2QBHBFicbTasZt6ne5apx5i0I5u9Qd+Lt8PvUcfyNSMa4Lm#n#GXxeAkzkhsjgF5ABI/fMZ+pbPf58cdbVsbadpGi5bNAlOtqmAYICPjN6M1cYCPdC#n#VTrN4Egu/hlqSaI7X/SpnP0=#QTvEyNopYkTzzmGk1Pm7Xk32SdxmIfQYPGiHaws2llXa9JC71sCnHXqHSnsSQsmY#n#YheZ28Cpz0nuF+Qc578kgX3e9warGYfdPtu0VH5B1ShSAC/aXmLqwq3wd5z+rt6+#n#fGYURuGfISrVHzmu+1g5mx/pe3BTXhB0KvwEsVd02BtasFcrfcBvlT3QPkzYaAqv#n#HTMdpj6k19E7WFLlzESiAvnIYj3nCrlQmPHY0RoKpDEIYAllzI6NaCRkW+qn6eEx#n#kKhgV/t0/6tjiZz2za6D3ULFOIThixdtIyPgnhekRzioFygWD8jAUke23lor0mKd#n#8dVTW6nbaw6Rg4MEBS5Iuw==#XIcOxtOtI3Zoz5gkw9GyV/r0SY8anhz4EehsyYHzm0vMHqxY1RAzLVlwZtbJS2FD#n#n4D/pdGqLfoNh/oy/teSV/Fn6f4aVNvlJqp+YhrZXKIbTMb4TT5UjTcipqXluaDj#n#3kLIs4mKfZh9S7g4Km4TrKgC7oXV/Tt7/BmO4eUYaJ+R7d9OGJM/soHIhYEFvn6h#n#xhPUxpNOq51KloXHhIf4KrrusneOWbgY0yvCrLPfCmSbgX2v3ZXkIJrlYn1nKt31#n#4rNuvLyTLB3twzERfjKQSRmJVmeA3ZCw4CA+Jg8vnc1FThlfKVBDaL8liusHsTWK#n#KuGG2COfzTUeM0v7nidKYw==#VIBFMDoM7ZnBtmEsfVRju/gaw3ZSCr6/UfbHEPv4qlVeYVdaBuGb1NnBn60tGNcd#n#/G+1TgunD6J7xr94fWgH5jHFNH8axp4x3plewSQMICtZWg3p7BJlx760k8tkoBXL#n#49bNnk1pL+JpgMlBkv5tIdoCg9KSyKVOZEgouoFLtT/6xKLgdpc8Hk37ocwSJ5Gh#n#5gRaVQ4e2w5J/pLOvM45TR4GPUS4EBVYIHJOR3e8sVUv5m15qI4X4IABkzjfJyb8#n#geucJvhKsPRI4u1Xt2jBap/jvRfQhYnWmAng6ZFkdxGHbmFtsBMaxZ5COwPgMiim#n#Zixp1oi7pnc7V8+erscySw==#AJJuIUlLz21lAbEfyhJv1/Dybxes9ODxZSrMBi371L1vfxJlvmQnJbQwY0IaTLiF#n#ClNVth1/9CiLZBeT/G1wQyPS0aqw+6kUVqd/rH19XGPqhCPVqE3Bk4ZxZ0qQ23nu#n#YHVNnoSY6MLvwT/BGxXlZggTqAZVpLwENR5Jsfd1aRsQRoc5lBaeTEySFHpxXnw/#n#4pBfiQCTeIZ3sV2jsdbSZtvPsvfclP2GrjcXXhcF/97rqtuB+ueTlvd+WneoKcdr#n#NmvM2QHrEk22LAK8MuO1gL5prd2OHoQzZTsuS1Js4B5a3KUhlQ+qLzh20IKAxnq9#n#S7RgEcfR/3GFlGlA156mBqQ=#ALE/kidnHGKAlQZcrMXP3Q2Yf9OGR1KfQIOxXoG3HFuBByAWRQlUh+GTLI9DLL/Z#n#jXduedD5gKfyhtRcDHNDTQOZ62azsLcFWqSmyyUZNEbAA1o93wGfBfb5bP7Atobg#n#hdn5RaOwH91lrSI+bprkFSrbrcX3WFuzEUkyVMtqF6+Hkv42KodyZOa5Y77RHRHt#n#zFq93twQIljWwggl0tRMzF6X091Niu5hd6dxhYPLj2bIMyVYIEuzwEpmBdx6wa06#n#0rZ0JJHWZOFfx30DI1FIOB/sLu8E8DvT1XGID+pypoIRXl1o4VVadO+Nz3ZK0E5c#n#3cNqphhZHiwCChI3uZ6CS+Q=#Wlb1S5QPEQXJbgpodceF32KhehlI0nVxeiZyaL0Y6fvufve0PLRYujYmjr2Blqq9#n#8TACo+zSF9JgD7yQ0p13qY7P6qbjaUDHo7u1CODPHI7FW6qJY+F6YljlUx3K+Q3X#n#1W90h8R37hqHEKn5tjkf2BGGflpTcmuozGY92nWBP9QJF1xEY7eOVb2tW94jul/r#n#DWSDJubN5lHdLa2ZkRMAdHUkZoauLlia7pcaxPtIvwkUf0UnHcgLKmv1T9fE3/u0#n#wRHhJNRa3XGWXXN9qoPnl1g0bGxBNVONOXa8QwIry1UN/4H398mSTYb3/4eqwMfz#n#LpaaJ4ZN8XqIYraOgpTfcQ==#AKhdSy0Segn/z41yAtJXfQq9Hy+rXdOLlvoS6S12kQD2WqooswmIUpy9WQjFewpH#n#Wi01hz9bKJbGzy3AQE09edfuF8kKbu7v29lyCqYhTsYZ0y02gGHMUtEFFrbnEShd#n#qoZX/IWsSeBJnu/Yr97Bi957Cq4oRO0Q/dHG1swFRH1d4xidiieWspLIXEhwjaiA#n#1p41rO2l3rgvlj4zh43QbuqbhFzj1XuUZlJ3UefejV+VrhTaIIa4oTf0ONksYcCh#n#ybavNO+RS4WYCW20Pt582mhDdRqlv94NMa7s5u+knE6dA8GmhFUnUN5w3cdbZ83E#n#d02h4vdQmbqqjPbBelueru8=#TGmAQvOeFSoek4zJAFVXojTDNGtj7q4UnMK1gEv6UAnbjHKMWdR7rVoAQTJttcFF#n#c8wQBzHe+qgdG8DjR4PGjZ00FJ73licBxYOTA4tUWI19JuNo/0/ezMm2MgUQgkkn#n#ehhIvsro6VIHp886GjyTmcq7xhTBdlhxY+68JNZ9CyqcQQOjfKWuHrX/b8WS0o9R#n#j3GP2FW4wWdSHWyr4OHfo8VeWV224LLttHGuxgeu6dluo9ebuUUIoFT8hEAeU4Uy#n#qwwiNqzooGUbWgp2rLcxSZUEkNPzTmYcw1GlSMyXXCJhuNTmyO9tN5hdz9nI/3PQ#n#xBI8kBDKKYMMNn1KtRqlWQ==#ZWqr/funAgzcemNtAG1z+pLXphzOFiQM9PSAc6oDrXiawICQ0dvFj5nKqoeNNYAG#n#ti3wGAlKQ1i2iqe2dVfnTKRsPdKKnFJbShgoz4Z0s5N8iVH0Ig/aa0z0CJPA5OzC#n#Hco7+LmDLgLER+21EfEsdK1eWg+yxZg1PRvXruHxnO96Gq4fxIZNPIJnoSUzMbEH#n#+f3ZvdQ890fo2GSR4HDDPy0aQgBxp6GNHhDwiaer7hFp7GLwwEq1H3LkWHThTtiv#n#s2Ug+clhWIp2u8fmooHjNKRK/3IcUjkFbnY1hwbQ1nbcfLO10sFaPfN1I7JBuTxR#n#s7hjtVD4Gpb8iv9HCGonzg==#cPZ8/eIi4++oG4ZLj0/tuO0xZgjTy9Vi6nm/0HKQvjFzXfngcyU/aU5GDKwSl3DH#n#7UTXCmaterJjMxidefNUVaZkqVoP7hrTH7sxZVvnOZZyvHue2P+pdv1jWrCZx9ry#n#FUFz8bsC6VHhj5uWviX0yBVOCr8Vr0La6y4O4NE+zENTqKLdB+eYpMrliTgj3FX2#n#ffyLuDtRnpqEIVbSGJDa9uJXMCieB+QN/gKC7GXGZNkbrRU8pRfGbyvnzAzlHLAo#n#ehY8cxjxE//tmAcpjPoFzJgMTMqpxBwIaCvQljWZsXZq+VP9EIUJVnc9W4wl3K9t#n#X6CpWtRXyCPzSUreoZF4DA==#ENg8sH42gHyMELsTRK0SWQIdsjNyxLtWUF7jtx0xAzjmGonRJjWCV81loejju7Xm#n#oIn01avDt6FqBdbT3kWtQGVRGVL6UL8nZpB+h8M527RBBsmsKcY92NIbF/tZ3YUf#n#noQn/fVT25eKt+0dS15q8p7o4zKnANBy24uktYzl5B//aS589SvkpUcl74N0imnZ#n#kyDkGSwgv4gu/8BgVU6ad5/socwFSKP56NJTiKPqJAqAHAXW24I3pNoD7wz6T/1G#n#AEY8yeteeqpqc1EtmS6XANKhpQT6C9No4+ydyQVbvUMjoNFJIj1nrw3LTfkwxKX4#n#yc48tTBx1KQTvVzWaSm0tg==#,prIuVEjY/ZgHq/R5k149fl/5sOg2d9zaq/5LMlmAmRA6Z3xBKRqtEfYsEp//+4nTLqbDrZ2GQ0zZLEUoEX1dTZ/xcf4LElCLlwN5VfQHZ5mlWI9Ppn6B952Ge5OY/XS5gZ7wXCrBjfx2taw7KPWbvw+dJSiFACBFAdO5/CtVjAVoLVNR6aukXCmamHeamJMixY+OkYEXA4wGpv75Ni1YwE7kswhx+6/GS7X/rGR1KIkzob8sQEGK4fKZKlFddMaGT1lGlvlAWxpXkJxUeIRfraq+HkFfJSCUG16YyyPl89ExEyHKB85mIPestp6i2iekhZZbdOOoRvrIbjU5VDhiWg==,56e0af43-11c5-499c-ab1b-80aea591a9cd,parlamentary,1375768567129,-----BEGIN CERTIFICATE-----#r##n#MIIDcjCCAlqgAwIBAgIFAIlL9yswDQYJKoZIhvcNAQEFBQAwWjENMAsGA1UECgwE#r##n#U3RhdDELMAkGA1UEBhMCTk8xDzANBgNVBAMMBjczMDA3MTErMCkGA1UECwwiS29t#r##n#bXVuYWwtIG9nIHJlZ2lvbmFsZGVwYXJ0ZW1lbnRldDAeFw0xMjA4MDYwNTMxMDJa#r##n#Fw0yNTA4MDYwNTMxMDJaMIGJMQwwCgYDVQQKDANPcmcxDjAMBgNVBAgMBVN0YXRl#r##n#MRAwDgYDVQQGEwdDb3VudHJ5MUgwRgYDVQQDDD9Wb3Rlcl8xWXpMQ2RxcmxySGIz#r##n#T3BuQ1RNbkxraGhrcWtORUxQNGlMa0xRcTNmOW1FPV9TaWduX183MzAwNzExDTAL#r##n#BgNVBAsMBFVuaXQwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC++o00#r##n#70U9EqFB5ISFDaCpIp33h5Lild7CbfHGd2eXZqF29a3LTDZJ0xcj6ML6uJHfAGHb#r##n#+Wp3HBj1bkk77VbQ56DB82ntz88neMrKKiZA3WIB/TgVD0U71Djh6czsd2q+UxgW#r##n#U/6TAHAMpXurb7pxw6AIHGrRnLPOGBNIcTikqqux0+IMpPDWEv6gK99CWN2GtvO+#r##n#Ds8oxPsGx3qIpKLkGq4ozBNaFE10kqLoO/WzIeETknzQy5YvF9v3Tu/BJufcI9LS#r##n#+XqczDX0G5HPJHWap9rB/YL/2Wa79HLP6I84LaF0VI+5rtKs5mOwXuSoVKBoSG9k#r##n#QmFSuQWd9JOYONrzAgMBAAGjDzANMAsGA1UdDwQEAwIGwDANBgkqhkiG9w0BAQUF#r##n#AAOCAQEAQ7ntcMb0kZZOk49M5rEgRtsac1u/upj6/xsS9aWFz/iZsHaPQKnnUFV2#r##n#e1Q4FnsGDfSXefLJDWyqOaObrMJ6c2pa8W09RVRcrUibkeLmUxC1PmifD3Gsr3jV#r##n#xnk+xMrGsjrjfHR3mCZ934Pboy3g4Wwz8heRwUA1mahRW6FO1QfGrDE2NcWXVM8V#r##n#FnY9RVYhoQkYqV2s34YhCD7WsmnK3dDnz3DI9w50LcWmf4oqGHbcqcO9LOPodF+O#r##n#BcprDKV5dPumapHKhKrXXJn6zcI8uESoFb0DtAN4LClJtsy2qDzOIrM8Ye4yOGMS#r##n#3x9u80KJrjmw0Skc/L6CWzGDOWyQOw==#r##n#-----END CERTIFICATE-----" +
        COMMA + VOTER_AREA_ID + COMMA + GIVEN_CONTEST_ID + COMMA +
        GIVEN_ELECTION_ID + COMMA + GIVEN_ELECTION_EVENT_ID + COMMA +
        "01024132990,CHANNEL_ID_UNCONTROLLED,1375768580765" + COMMA +
        GIVEN_VOTE_Z_K_PROOF_SIG;
    private static final String GIVEN_REDUCED_SAMPLE_LINE = GIVEN_UUID + COMMA +
        GIVEN_AUTH_TOKEN + COMMA +
        "327754c3-ac5d-44ba-8413-dc29c0f36b42,IWvRkimscLc7ZnzHRhq5HkKtL0XXlMwZEFu2w7iIdSBCWDAKuxgUNPkA66dqZ7Oy#n#uvqePFoXVHLgemivhxRHAtkKALAtdc3ihfDN99u3vrfiPinPLHcidemy056uxPO+#n#9mb96Cs4RVhFDY3DnW6BuZQUuITmrBOEhaaxja7qbijKD7SNX2bwqRv0j4GeasLa#n#GosqDfFqEYd9aLr7x7M6xkk4AhyoPHG7qAI/A1SiwDxF2ocycQgJk7kl4yeJDgBK#n#PFw0F3xZ1f8yVJEr6d8Su8OwdXN/NiFlX9bjKifFK2bgMqJvlsAPXLjK5ms/2VeS#n#IE4atuMnZquzJMpjEICHcQ==#BuuEgmh0HZdfhNAaD+pVdg8Kgw/lAvU8Bq/07J6ooFz+QzD2uuhexGlqkRCUIq2s#n#bEwYzTLLy+QS+ZeBK5t4k7Gq/wOg85/VLvFcW7wi2sWO5o9HR9k11lX8rW0WxCIn#n#vFzYsZNwWbPiHc7hNswodqTJsIkNpdxWajO8nEMsn4jbSmvcSI1XNTd6mKANuNSJ#n#PUYsyEoUSmEPO8VB29mvEcG4O/EhGLBaEFqLQCFn3Da0NoxO20BiR7D99jHz1M70#n#YeP459wziI94UpetuwTaUKW+Pw8qifwyU/AH8r1Th/MGWncvriPNnEx3Sv6GOeUr#n#t/ImHHGmlYoPrvbGKGQUxw==#AIXBRFx299j0+knJHeC61pJUdJc9RD9teNfo9vAtQh+cMEp7OvGbp3Y2M7tlSklS#n#ovAP3TVjltlqfwteGJXqP/r/eTWCCPmivypjQ7FeOAFTtjrjVa2SMRaAEEaNxq7h#n#/xE1KE9lto+XXZ/NB69m035763kQQemFHIuDeNoDNu0sVpkgtkViJzWGu2b0ZCy2#n#2Sxf69qTntXCMv68tlQWNmFx889DSRpOhDXV3ivkV28J1GfO6sjS5MIWM3a7CZFC#n#NPTf30f4/IZCrnepKjGINxTn/18TWLt3jFYC/jM7I0bLTGVUs8hweC36F9nMKR32#n#dOn65AizJOtKzaYn4cmTxw4=#RLHu2eykn2di6LrMPG/ov+pR/hkx1THELRV5RYPOexiGHjKecIJCe83tskFZFeCr#n#vFWPjgNlQxl1L4GkHICSQ7rJ9rpj9rOSQvGgjm2WqRMO329FmWUCu/MQFQP3u5EO#n#27WUNxeVB9gRufDTtd4f+SZ+nDkW4D/k8GsaJ/GaNTLSgAH7WMuj0H7AVsvHB0y6#n#abJUu8QFZkewmW9RC+Bw2NKimXdlHu9TbhuG3ZuPeXK2ccWpt5HVwRVgYI+/d+p7#n#Gbhl+f1CAh3rWTaAhrsl2ExLav/IrAiXLOrcmEQtnAFq4aXVZP+YwQmfW0NHmkow#n#9H03qfEhPX6f8UH3o6lEmw==#AIJrTHjlP6vjvMaEwkxdYlX7TYgV5WsTqBax91Vt6trRnHs2j+hZE29anlIS3VRE#n#+epvUA5j3WX8i0KEdX/+bi7AF3lYowuHtWGPvNq8CL9Pt8RnteomIqObNx9dglX7#n#7Ic5q4FawXA0dSEpTlZS9YxFSq7sduycaF+h5cfofV5nvYFxapv7k4hJG2XEEZIy#n#ZsCR3AmxVybfnrKDG2QBHBFicbTasZt6ne5apx5i0I5u9Qd+Lt8PvUcfyNSMa4Lm#n#GXxeAkzkhsjgF5ABI/fMZ+pbPf58cdbVsbadpGi5bNAlOtqmAYICPjN6M1cYCPdC#n#VTrN4Egu/hlqSaI7X/SpnP0=#QTvEyNopYkTzzmGk1Pm7Xk32SdxmIfQYPGiHaws2llXa9JC71sCnHXqHSnsSQsmY#n#YheZ28Cpz0nuF+Qc578kgX3e9warGYfdPtu0VH5B1ShSAC/aXmLqwq3wd5z+rt6+#n#fGYURuGfISrVHzmu+1g5mx/pe3BTXhB0KvwEsVd02BtasFcrfcBvlT3QPkzYaAqv#n#HTMdpj6k19E7WFLlzESiAvnIYj3nCrlQmPHY0RoKpDEIYAllzI6NaCRkW+qn6eEx#n#kKhgV/t0/6tjiZz2za6D3ULFOIThixdtIyPgnhekRzioFygWD8jAUke23lor0mKd#n#8dVTW6nbaw6Rg4MEBS5Iuw==#XIcOxtOtI3Zoz5gkw9GyV/r0SY8anhz4EehsyYHzm0vMHqxY1RAzLVlwZtbJS2FD#n#n4D/pdGqLfoNh/oy/teSV/Fn6f4aVNvlJqp+YhrZXKIbTMb4TT5UjTcipqXluaDj#n#3kLIs4mKfZh9S7g4Km4TrKgC7oXV/Tt7/BmO4eUYaJ+R7d9OGJM/soHIhYEFvn6h#n#xhPUxpNOq51KloXHhIf4KrrusneOWbgY0yvCrLPfCmSbgX2v3ZXkIJrlYn1nKt31#n#4rNuvLyTLB3twzERfjKQSRmJVmeA3ZCw4CA+Jg8vnc1FThlfKVBDaL8liusHsTWK#n#KuGG2COfzTUeM0v7nidKYw==#VIBFMDoM7ZnBtmEsfVRju/gaw3ZSCr6/UfbHEPv4qlVeYVdaBuGb1NnBn60tGNcd#n#/G+1TgunD6J7xr94fWgH5jHFNH8axp4x3plewSQMICtZWg3p7BJlx760k8tkoBXL#n#49bNnk1pL+JpgMlBkv5tIdoCg9KSyKVOZEgouoFLtT/6xKLgdpc8Hk37ocwSJ5Gh#n#5gRaVQ4e2w5J/pLOvM45TR4GPUS4EBVYIHJOR3e8sVUv5m15qI4X4IABkzjfJyb8#n#geucJvhKsPRI4u1Xt2jBap/jvRfQhYnWmAng6ZFkdxGHbmFtsBMaxZ5COwPgMiim#n#Zixp1oi7pnc7V8+erscySw==#AJJuIUlLz21lAbEfyhJv1/Dybxes9ODxZSrMBi371L1vfxJlvmQnJbQwY0IaTLiF#n#ClNVth1/9CiLZBeT/G1wQyPS0aqw+6kUVqd/rH19XGPqhCPVqE3Bk4ZxZ0qQ23nu#n#YHVNnoSY6MLvwT/BGxXlZggTqAZVpLwENR5Jsfd1aRsQRoc5lBaeTEySFHpxXnw/#n#4pBfiQCTeIZ3sV2jsdbSZtvPsvfclP2GrjcXXhcF/97rqtuB+ueTlvd+WneoKcdr#n#NmvM2QHrEk22LAK8MuO1gL5prd2OHoQzZTsuS1Js4B5a3KUhlQ+qLzh20IKAxnq9#n#S7RgEcfR/3GFlGlA156mBqQ=#ALE/kidnHGKAlQZcrMXP3Q2Yf9OGR1KfQIOxXoG3HFuBByAWRQlUh+GTLI9DLL/Z#n#jXduedD5gKfyhtRcDHNDTQOZ62azsLcFWqSmyyUZNEbAA1o93wGfBfb5bP7Atobg#n#hdn5RaOwH91lrSI+bprkFSrbrcX3WFuzEUkyVMtqF6+Hkv42KodyZOa5Y77RHRHt#n#zFq93twQIljWwggl0tRMzF6X091Niu5hd6dxhYPLj2bIMyVYIEuzwEpmBdx6wa06#n#0rZ0JJHWZOFfx30DI1FIOB/sLu8E8DvT1XGID+pypoIRXl1o4VVadO+Nz3ZK0E5c#n#3cNqphhZHiwCChI3uZ6CS+Q=#Wlb1S5QPEQXJbgpodceF32KhehlI0nVxeiZyaL0Y6fvufve0PLRYujYmjr2Blqq9#n#8TACo+zSF9JgD7yQ0p13qY7P6qbjaUDHo7u1CODPHI7FW6qJY+F6YljlUx3K+Q3X#n#1W90h8R37hqHEKn5tjkf2BGGflpTcmuozGY92nWBP9QJF1xEY7eOVb2tW94jul/r#n#DWSDJubN5lHdLa2ZkRMAdHUkZoauLlia7pcaxPtIvwkUf0UnHcgLKmv1T9fE3/u0#n#wRHhJNRa3XGWXXN9qoPnl1g0bGxBNVONOXa8QwIry1UN/4H398mSTYb3/4eqwMfz#n#LpaaJ4ZN8XqIYraOgpTfcQ==#AKhdSy0Segn/z41yAtJXfQq9Hy+rXdOLlvoS6S12kQD2WqooswmIUpy9WQjFewpH#n#Wi01hz9bKJbGzy3AQE09edfuF8kKbu7v29lyCqYhTsYZ0y02gGHMUtEFFrbnEShd#n#qoZX/IWsSeBJnu/Yr97Bi957Cq4oRO0Q/dHG1swFRH1d4xidiieWspLIXEhwjaiA#n#1p41rO2l3rgvlj4zh43QbuqbhFzj1XuUZlJ3UefejV+VrhTaIIa4oTf0ONksYcCh#n#ybavNO+RS4WYCW20Pt582mhDdRqlv94NMa7s5u+knE6dA8GmhFUnUN5w3cdbZ83E#n#d02h4vdQmbqqjPbBelueru8=#TGmAQvOeFSoek4zJAFVXojTDNGtj7q4UnMK1gEv6UAnbjHKMWdR7rVoAQTJttcFF#n#c8wQBzHe+qgdG8DjR4PGjZ00FJ73licBxYOTA4tUWI19JuNo/0/ezMm2MgUQgkkn#n#ehhIvsro6VIHp886GjyTmcq7xhTBdlhxY+68JNZ9CyqcQQOjfKWuHrX/b8WS0o9R#n#j3GP2FW4wWdSHWyr4OHfo8VeWV224LLttHGuxgeu6dluo9ebuUUIoFT8hEAeU4Uy#n#qwwiNqzooGUbWgp2rLcxSZUEkNPzTmYcw1GlSMyXXCJhuNTmyO9tN5hdz9nI/3PQ#n#xBI8kBDKKYMMNn1KtRqlWQ==#ZWqr/funAgzcemNtAG1z+pLXphzOFiQM9PSAc6oDrXiawICQ0dvFj5nKqoeNNYAG#n#ti3wGAlKQ1i2iqe2dVfnTKRsPdKKnFJbShgoz4Z0s5N8iVH0Ig/aa0z0CJPA5OzC#n#Hco7+LmDLgLER+21EfEsdK1eWg+yxZg1PRvXruHxnO96Gq4fxIZNPIJnoSUzMbEH#n#+f3ZvdQ890fo2GSR4HDDPy0aQgBxp6GNHhDwiaer7hFp7GLwwEq1H3LkWHThTtiv#n#s2Ug+clhWIp2u8fmooHjNKRK/3IcUjkFbnY1hwbQ1nbcfLO10sFaPfN1I7JBuTxR#n#s7hjtVD4Gpb8iv9HCGonzg==#cPZ8/eIi4++oG4ZLj0/tuO0xZgjTy9Vi6nm/0HKQvjFzXfngcyU/aU5GDKwSl3DH#n#7UTXCmaterJjMxidefNUVaZkqVoP7hrTH7sxZVvnOZZyvHue2P+pdv1jWrCZx9ry#n#FUFz8bsC6VHhj5uWviX0yBVOCr8Vr0La6y4O4NE+zENTqKLdB+eYpMrliTgj3FX2#n#ffyLuDtRnpqEIVbSGJDa9uJXMCieB+QN/gKC7GXGZNkbrRU8pRfGbyvnzAzlHLAo#n#ehY8cxjxE//tmAcpjPoFzJgMTMqpxBwIaCvQljWZsXZq+VP9EIUJVnc9W4wl3K9t#n#X6CpWtRXyCPzSUreoZF4DA==#ENg8sH42gHyMELsTRK0SWQIdsjNyxLtWUF7jtx0xAzjmGonRJjWCV81loejju7Xm#n#oIn01avDt6FqBdbT3kWtQGVRGVL6UL8nZpB+h8M527RBBsmsKcY92NIbF/tZ3YUf#n#noQn/fVT25eKt+0dS15q8p7o4zKnANBy24uktYzl5B//aS589SvkpUcl74N0imnZ#n#kyDkGSwgv4gu/8BgVU6ad5/socwFSKP56NJTiKPqJAqAHAXW24I3pNoD7wz6T/1G#n#AEY8yeteeqpqc1EtmS6XANKhpQT6C9No4+ydyQVbvUMjoNFJIj1nrw3LTfkwxKX4#n#yc48tTBx1KQTvVzWaSm0tg==#,prIuVEjY/ZgHq/R5k149fl/5sOg2d9zaq/5LMlmAmRA6Z3xBKRqtEfYsEp//+4nTLqbDrZ2GQ0zZLEUoEX1dTZ/xcf4LElCLlwN5VfQHZ5mlWI9Ppn6B952Ge5OY/XS5gZ7wXCrBjfx2taw7KPWbvw+dJSiFACBFAdO5/CtVjAVoLVNR6aukXCmamHeamJMixY+OkYEXA4wGpv75Ni1YwE7kswhx+6/GS7X/rGR1KIkzob8sQEGK4fKZKlFddMaGT1lGlvlAWxpXkJxUeIRfraq+HkFfJSCUG16YyyPl89ExEyHKB85mIPestp6i2iekhZZbdOOoRvrIbjU5VDhiWg==,56e0af43-11c5-499c-ab1b-80aea591a9cd,parlamentary,1375768567129,-----BEGIN CERTIFICATE-----#r##n#MIIDcjCCAlqgAwIBAgIFAIlL9yswDQYJKoZIhvcNAQEFBQAwWjENMAsGA1UECgwE#r##n#U3RhdDELMAkGA1UEBhMCTk8xDzANBgNVBAMMBjczMDA3MTErMCkGA1UECwwiS29t#r##n#bXVuYWwtIG9nIHJlZ2lvbmFsZGVwYXJ0ZW1lbnRldDAeFw0xMjA4MDYwNTMxMDJa#r##n#Fw0yNTA4MDYwNTMxMDJaMIGJMQwwCgYDVQQKDANPcmcxDjAMBgNVBAgMBVN0YXRl#r##n#MRAwDgYDVQQGEwdDb3VudHJ5MUgwRgYDVQQDDD9Wb3Rlcl8xWXpMQ2RxcmxySGIz#r##n#T3BuQ1RNbkxraGhrcWtORUxQNGlMa0xRcTNmOW1FPV9TaWduX183MzAwNzExDTAL#r##n#BgNVBAsMBFVuaXQwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC++o00#r##n#70U9EqFB5ISFDaCpIp33h5Lild7CbfHGd2eXZqF29a3LTDZJ0xcj6ML6uJHfAGHb#r##n#+Wp3HBj1bkk77VbQ56DB82ntz88neMrKKiZA3WIB/TgVD0U71Djh6czsd2q+UxgW#r##n#U/6TAHAMpXurb7pxw6AIHGrRnLPOGBNIcTikqqux0+IMpPDWEv6gK99CWN2GtvO+#r##n#Ds8oxPsGx3qIpKLkGq4ozBNaFE10kqLoO/WzIeETknzQy5YvF9v3Tu/BJufcI9LS#r##n#+XqczDX0G5HPJHWap9rB/YL/2Wa79HLP6I84LaF0VI+5rtKs5mOwXuSoVKBoSG9k#r##n#QmFSuQWd9JOYONrzAgMBAAGjDzANMAsGA1UdDwQEAwIGwDANBgkqhkiG9w0BAQUF#r##n#AAOCAQEAQ7ntcMb0kZZOk49M5rEgRtsac1u/upj6/xsS9aWFz/iZsHaPQKnnUFV2#r##n#e1Q4FnsGDfSXefLJDWyqOaObrMJ6c2pa8W09RVRcrUibkeLmUxC1PmifD3Gsr3jV#r##n#xnk+xMrGsjrjfHR3mCZ934Pboy3g4Wwz8heRwUA1mahRW6FO1QfGrDE2NcWXVM8V#r##n#FnY9RVYhoQkYqV2s34YhCD7WsmnK3dDnz3DI9w50LcWmf4oqGHbcqcO9LOPodF+O#r##n#BcprDKV5dPumapHKhKrXXJn6zcI8uESoFb0DtAN4LClJtsy2qDzOIrM8Ye4yOGMS#r##n#3x9u80KJrjmw0Skc/L6CWzGDOWyQOw==#r##n#-----END CERTIFICATE-----" +
        COMMA + VOTER_AREA_ID + COMMA + GIVEN_CONTEST_ID + COMMA +
        GIVEN_ELECTION_ID + COMMA + GIVEN_ELECTION_EVENT_ID + COMMA +
        "01024132990,CHANNEL_ID_UNCONTROLLED,1375768580765";
    private static final String GIVEN_VOTING_RECEIPT = "ESRciAwG4M71UWpIYIW0RW7RF4eSDYCT1V9Zatm1wsM=";
    private static final byte[] EXPECTED_SHA_256 = new byte[] {
            (byte) 227, (byte) 176, (byte) 196, 66, (byte) 152, (byte) 252, 28,
            20, (byte) 154, (byte) 251, (byte) 244, (byte) 200, (byte) 153, 111,
            (byte) 185, 36, 39, (byte) 174, 65, (byte) 228, 100, (byte) 155,
            (byte) 147, 76, (byte) 164, (byte) 149, (byte) 153, 27, 120, 82,
            (byte) 184, 85
        };
    private static final String GIVEN_BROKEN_AUTH_TOKEN = "sO0ABXNyADtjb20uc2N5dGwuZXZvdGUucHJvdG9jb2wuaW50ZWdyYXRpb24udm90aW5nLm1vZGVsLkF1dGhUb2tlbvz+Wz5pky7LAgAWSQAhX2FkdmFuY2VPZkV4cGlyYXRpb25UaW1lSW5NaW51dGVzSQAaX2FmdGVyQ2xvc2luZ1RpbWVJblNlY29uZHNKAAVfYXNJZEkAGF9leHBpcmF0aW9uVGltZUluTWludXRlc0oAA190c1sAD19hdXRoU2VydmljZVNpZ3QAAltCTAAJX2NvbnRlc3RzdAAQTGphdmEvdXRpbC9MaXN0O0wAGl9jb250cm9sbGVkUmV0dXJuY29kZXNUeXBldAASTGphdmEvbGFuZy9TdHJpbmc7TAAQX2VsZWN0aW9uRXZlbnRJZHEAfgADTAALX2VsZWN0aW9uSWRxAH4AA0wAA19pZHEAfgADTAAJX2ludFRva2VudABBTGNvbS9zY3l0bC9ldm90ZS9wcm90b2NvbC9pbnRlZ3JhdGlvbi92b3RpbmcvbW9kZWwvSW50ZXJuYWxUb2tlbjtMABdfaW50VG9rZW5FbnRpdHlQcm92aWRlcnEAfgADTAADX2lwcQB+AANMAA1fcG9sbGluZ1BsYWNldABATGNvbS9zY3l0bC9ldm90ZS9wcm90b2NvbC9pbnRlZ3JhdGlvbi92b3RpbmcvbW9kZWwvUG9sbGluZ1BsYWNlO0wAHF91bmNvbnRyb2xsZWRSZXR1cm5jb2Rlc1R5cGVxAH4AA0wACl92b3RlckFyZWFxAH4AA0wADF92b3RlckNvbW1JZHEAfgADTAAPX3ZvdGVyRmlyc3ROYW1lcQB+AANMABBfdm90ZXJJZGVudGlmaWVydABDTGNvbS9zY3l0bC9ldm90ZS9wcm90b2NvbC9pbnRlZ3JhdGlvbi92b3RpbmcvbW9kZWwvVm90ZXJJZGVudGlmaWVyO0wADl92b3Rlckxhc3ROYW1lcQB+AANMAAxfdm90aW5nTW9kZXNxAH4AAnhwAAAABQAAAlgAAAAAAAAIAAAAAB4AAAFAUjJdWXVyAAJbQqzzF/gGCFTgAgAAeHAAAAEAkiHd/dQKfImbVY7Yq5Sfbw5qNsYwffE0FJRcycaOAte4A2eu0GhYFs/LRzcp5FsX4dV/wmIRuItJlkUIsvz2CKD95kut6P3+OUbGfdSJWv1olkvvdds3WicfpvlXTp081eiAv2lPjsqZPTz3Ebuce7c+nO09PEWCZRI6KcG0Iw5DisP71OEUuoTBxzP56bVI8Sq2/d/G7WMLFaFWRyw9QwDTvdOwW/iTZ6FJ7bGFkqH51rcDfrvl/8SgybUlQwHg1Hx6tw2P32ZDREvkPidQW9BlvBp8NXc0UbUTGt16d1+aHdw/7E1UtVmaqgkcIEC/aZn95lSP4ueoKF2wPqR17XNyABNqYXZhLnV0aWwuQXJyYXlMaXN0eIHSHZnHYZ0DAAFJAARzaXpleHAAAAABdwQAAAABc3IAQGNvbS5zY3l0bC5ldm90ZS5wcm90b2NvbC5pbnRlZ3JhdGlvbi52b3RpbmcubW9kZWwuQWxsb3dlZENvbnRlc3QiWqLrfd15KQIAA0wACl9jb250ZXN0SWRxAH4AA0wAC19lbGVjdGlvbklkcQB+AANMAAZfdm90ZWRxAH4AA3hwdAAGMDAwMDE4dAACMDF0AAEweHQABlNDUkVFTnQABjczMDA3MXQAA2lkNXQAJDMyNzc1NGMzLWFjNWQtNDRiYS04NDEzLWRjMjljMGYzNmI0MnNyADxjb20uc2N5dGwuZXZvdGUucHJvdG9jb2wuaW50ZWdyYXRpb24udm90aW5nLm1vZGVsLk1pbklEVG9rZW7g1pITYjnPpQIABEoAA190c0wAA19pZHEAfgADTAAFX2luZm9xAH4AA0wACF92b3RlcklkcQB+AAN4cAAAAUBSMly1dAAkNTZlMGFmNDMtMTFjNS00OTljLWFiMWItODBhZWE1OTFhOWNkdABrI1R1ZSBBdWcgMDYgMDc6NTY6MDYgQ0VTVCAyMDEzCnVzZXJJZD0wMTAyNDEzMjk5MAp0cz0xMzc1NzY4NTY2OTY1CmlkPTU2ZTBhZjQzLTExYzUtNDk5Yy1hYjFiLTgwYWVhNTkxYTljZAp0AAswMTAyNDEzMjk5MHQADFVTRVJQQVNTV09SRHQACzEwLjAuMzIuMjQzc3IAPmNvbS5zY3l0bC5ldm90ZS5wcm90b2NvbC5pbnRlZ3JhdGlvbi52b3RpbmcubW9kZWwuUG9sbGluZ1BsYWNl1/fPlAehz24CAAdMAA1fYWRkcmVzc0xpbmUxcQB+AANMAA1fYWRkcmVzc0xpbmUycQB+AANMAA1fYWRkcmVzc0xpbmUzcQB+AANMAAVfbmFtZXEAfgADTAANX29wZW5pbmdIb3Vyc3EAfgACTAAJX3Bvc3RUb3ducQB+AANMAAtfcG9zdGFsQ29kZXEAfgADeHBwcHBwc3EAfgAKAAAAAHcEAAAAAHhwcHEAfgARdAAdNzMwMDcxLjQ3LjE4LjE4MjQuMTgyNDAwLjAwMDV0AAVmYWxzZXQAB1JhZ25hcnJzcgBBY29tLnNjeXRsLmV2b3RlLnByb3RvY29sLmludGVncmF0aW9uLnZvdGluZy5tb2RlbC5Wb3RlcklkZW50aWZpZXLKvqZX4QyCdgIAAkwACF9zcGFyZUlkcQB+AANMAAhfdm90ZXJJZHEAfgADeHB0AAswMTAyNDEzMjk5MHQACzAxMDI0MTMyOTkwdAARTG9cdTAwRjBiclx1MDBGM2tzcQB+AAoAAAABdwQAAAABc3IARGNvbS5zY3l0bC5ldm90ZS5wcm90b2NvbC5pbnRlZ3JhdGlvbi52b3RpbmcubW9kZWwuRWxlY3Rpb25Wb3RpbmdNb2RllMcp1WIDaxECAAJMAAtfZWxlY3Rpb25JZHEAfgADTAALX3ZvdGluZ01vZGVxAH4AA3hwdAACMDF0AAEyeA==";
    private static final String GIVEN_SAMPLE_LINE_WITH_BROKEN_AUTH_TOKEN = GIVEN_UUID +
        COMMA + GIVEN_BROKEN_AUTH_TOKEN + COMMA +
        "327754c3-ac5d-44ba-8413-dc29c0f36b42,IWvRkimscLc7ZnzHRhq5HkKtL0XXlMwZEFu2w7iIdSBCWDAKuxgUNPkA66dqZ7Oy#n#uvqePFoXVHLgemivhxRHAtkKALAtdc3ihfDN99u3vrfiPinPLHcidemy056uxPO+#n#9mb96Cs4RVhFDY3DnW6BuZQUuITmrBOEhaaxja7qbijKD7SNX2bwqRv0j4GeasLa#n#GosqDfFqEYd9aLr7x7M6xkk4AhyoPHG7qAI/A1SiwDxF2ocycQgJk7kl4yeJDgBK#n#PFw0F3xZ1f8yVJEr6d8Su8OwdXN/NiFlX9bjKifFK2bgMqJvlsAPXLjK5ms/2VeS#n#IE4atuMnZquzJMpjEICHcQ==#BuuEgmh0HZdfhNAaD+pVdg8Kgw/lAvU8Bq/07J6ooFz+QzD2uuhexGlqkRCUIq2s#n#bEwYzTLLy+QS+ZeBK5t4k7Gq/wOg85/VLvFcW7wi2sWO5o9HR9k11lX8rW0WxCIn#n#vFzYsZNwWbPiHc7hNswodqTJsIkNpdxWajO8nEMsn4jbSmvcSI1XNTd6mKANuNSJ#n#PUYsyEoUSmEPO8VB29mvEcG4O/EhGLBaEFqLQCFn3Da0NoxO20BiR7D99jHz1M70#n#YeP459wziI94UpetuwTaUKW+Pw8qifwyU/AH8r1Th/MGWncvriPNnEx3Sv6GOeUr#n#t/ImHHGmlYoPrvbGKGQUxw==#AIXBRFx299j0+knJHeC61pJUdJc9RD9teNfo9vAtQh+cMEp7OvGbp3Y2M7tlSklS#n#ovAP3TVjltlqfwteGJXqP/r/eTWCCPmivypjQ7FeOAFTtjrjVa2SMRaAEEaNxq7h#n#/xE1KE9lto+XXZ/NB69m035763kQQemFHIuDeNoDNu0sVpkgtkViJzWGu2b0ZCy2#n#2Sxf69qTntXCMv68tlQWNmFx889DSRpOhDXV3ivkV28J1GfO6sjS5MIWM3a7CZFC#n#NPTf30f4/IZCrnepKjGINxTn/18TWLt3jFYC/jM7I0bLTGVUs8hweC36F9nMKR32#n#dOn65AizJOtKzaYn4cmTxw4=#RLHu2eykn2di6LrMPG/ov+pR/hkx1THELRV5RYPOexiGHjKecIJCe83tskFZFeCr#n#vFWPjgNlQxl1L4GkHICSQ7rJ9rpj9rOSQvGgjm2WqRMO329FmWUCu/MQFQP3u5EO#n#27WUNxeVB9gRufDTtd4f+SZ+nDkW4D/k8GsaJ/GaNTLSgAH7WMuj0H7AVsvHB0y6#n#abJUu8QFZkewmW9RC+Bw2NKimXdlHu9TbhuG3ZuPeXK2ccWpt5HVwRVgYI+/d+p7#n#Gbhl+f1CAh3rWTaAhrsl2ExLav/IrAiXLOrcmEQtnAFq4aXVZP+YwQmfW0NHmkow#n#9H03qfEhPX6f8UH3o6lEmw==#AIJrTHjlP6vjvMaEwkxdYlX7TYgV5WsTqBax91Vt6trRnHs2j+hZE29anlIS3VRE#n#+epvUA5j3WX8i0KEdX/+bi7AF3lYowuHtWGPvNq8CL9Pt8RnteomIqObNx9dglX7#n#7Ic5q4FawXA0dSEpTlZS9YxFSq7sduycaF+h5cfofV5nvYFxapv7k4hJG2XEEZIy#n#ZsCR3AmxVybfnrKDG2QBHBFicbTasZt6ne5apx5i0I5u9Qd+Lt8PvUcfyNSMa4Lm#n#GXxeAkzkhsjgF5ABI/fMZ+pbPf58cdbVsbadpGi5bNAlOtqmAYICPjN6M1cYCPdC#n#VTrN4Egu/hlqSaI7X/SpnP0=#QTvEyNopYkTzzmGk1Pm7Xk32SdxmIfQYPGiHaws2llXa9JC71sCnHXqHSnsSQsmY#n#YheZ28Cpz0nuF+Qc578kgX3e9warGYfdPtu0VH5B1ShSAC/aXmLqwq3wd5z+rt6+#n#fGYURuGfISrVHzmu+1g5mx/pe3BTXhB0KvwEsVd02BtasFcrfcBvlT3QPkzYaAqv#n#HTMdpj6k19E7WFLlzESiAvnIYj3nCrlQmPHY0RoKpDEIYAllzI6NaCRkW+qn6eEx#n#kKhgV/t0/6tjiZz2za6D3ULFOIThixdtIyPgnhekRzioFygWD8jAUke23lor0mKd#n#8dVTW6nbaw6Rg4MEBS5Iuw==#XIcOxtOtI3Zoz5gkw9GyV/r0SY8anhz4EehsyYHzm0vMHqxY1RAzLVlwZtbJS2FD#n#n4D/pdGqLfoNh/oy/teSV/Fn6f4aVNvlJqp+YhrZXKIbTMb4TT5UjTcipqXluaDj#n#3kLIs4mKfZh9S7g4Km4TrKgC7oXV/Tt7/BmO4eUYaJ+R7d9OGJM/soHIhYEFvn6h#n#xhPUxpNOq51KloXHhIf4KrrusneOWbgY0yvCrLPfCmSbgX2v3ZXkIJrlYn1nKt31#n#4rNuvLyTLB3twzERfjKQSRmJVmeA3ZCw4CA+Jg8vnc1FThlfKVBDaL8liusHsTWK#n#KuGG2COfzTUeM0v7nidKYw==#VIBFMDoM7ZnBtmEsfVRju/gaw3ZSCr6/UfbHEPv4qlVeYVdaBuGb1NnBn60tGNcd#n#/G+1TgunD6J7xr94fWgH5jHFNH8axp4x3plewSQMICtZWg3p7BJlx760k8tkoBXL#n#49bNnk1pL+JpgMlBkv5tIdoCg9KSyKVOZEgouoFLtT/6xKLgdpc8Hk37ocwSJ5Gh#n#5gRaVQ4e2w5J/pLOvM45TR4GPUS4EBVYIHJOR3e8sVUv5m15qI4X4IABkzjfJyb8#n#geucJvhKsPRI4u1Xt2jBap/jvRfQhYnWmAng6ZFkdxGHbmFtsBMaxZ5COwPgMiim#n#Zixp1oi7pnc7V8+erscySw==#AJJuIUlLz21lAbEfyhJv1/Dybxes9ODxZSrMBi371L1vfxJlvmQnJbQwY0IaTLiF#n#ClNVth1/9CiLZBeT/G1wQyPS0aqw+6kUVqd/rH19XGPqhCPVqE3Bk4ZxZ0qQ23nu#n#YHVNnoSY6MLvwT/BGxXlZggTqAZVpLwENR5Jsfd1aRsQRoc5lBaeTEySFHpxXnw/#n#4pBfiQCTeIZ3sV2jsdbSZtvPsvfclP2GrjcXXhcF/97rqtuB+ueTlvd+WneoKcdr#n#NmvM2QHrEk22LAK8MuO1gL5prd2OHoQzZTsuS1Js4B5a3KUhlQ+qLzh20IKAxnq9#n#S7RgEcfR/3GFlGlA156mBqQ=#ALE/kidnHGKAlQZcrMXP3Q2Yf9OGR1KfQIOxXoG3HFuBByAWRQlUh+GTLI9DLL/Z#n#jXduedD5gKfyhtRcDHNDTQOZ62azsLcFWqSmyyUZNEbAA1o93wGfBfb5bP7Atobg#n#hdn5RaOwH91lrSI+bprkFSrbrcX3WFuzEUkyVMtqF6+Hkv42KodyZOa5Y77RHRHt#n#zFq93twQIljWwggl0tRMzF6X091Niu5hd6dxhYPLj2bIMyVYIEuzwEpmBdx6wa06#n#0rZ0JJHWZOFfx30DI1FIOB/sLu8E8DvT1XGID+pypoIRXl1o4VVadO+Nz3ZK0E5c#n#3cNqphhZHiwCChI3uZ6CS+Q=#Wlb1S5QPEQXJbgpodceF32KhehlI0nVxeiZyaL0Y6fvufve0PLRYujYmjr2Blqq9#n#8TACo+zSF9JgD7yQ0p13qY7P6qbjaUDHo7u1CODPHI7FW6qJY+F6YljlUx3K+Q3X#n#1W90h8R37hqHEKn5tjkf2BGGflpTcmuozGY92nWBP9QJF1xEY7eOVb2tW94jul/r#n#DWSDJubN5lHdLa2ZkRMAdHUkZoauLlia7pcaxPtIvwkUf0UnHcgLKmv1T9fE3/u0#n#wRHhJNRa3XGWXXN9qoPnl1g0bGxBNVONOXa8QwIry1UN/4H398mSTYb3/4eqwMfz#n#LpaaJ4ZN8XqIYraOgpTfcQ==#AKhdSy0Segn/z41yAtJXfQq9Hy+rXdOLlvoS6S12kQD2WqooswmIUpy9WQjFewpH#n#Wi01hz9bKJbGzy3AQE09edfuF8kKbu7v29lyCqYhTsYZ0y02gGHMUtEFFrbnEShd#n#qoZX/IWsSeBJnu/Yr97Bi957Cq4oRO0Q/dHG1swFRH1d4xidiieWspLIXEhwjaiA#n#1p41rO2l3rgvlj4zh43QbuqbhFzj1XuUZlJ3UefejV+VrhTaIIa4oTf0ONksYcCh#n#ybavNO+RS4WYCW20Pt582mhDdRqlv94NMa7s5u+knE6dA8GmhFUnUN5w3cdbZ83E#n#d02h4vdQmbqqjPbBelueru8=#TGmAQvOeFSoek4zJAFVXojTDNGtj7q4UnMK1gEv6UAnbjHKMWdR7rVoAQTJttcFF#n#c8wQBzHe+qgdG8DjR4PGjZ00FJ73licBxYOTA4tUWI19JuNo/0/ezMm2MgUQgkkn#n#ehhIvsro6VIHp886GjyTmcq7xhTBdlhxY+68JNZ9CyqcQQOjfKWuHrX/b8WS0o9R#n#j3GP2FW4wWdSHWyr4OHfo8VeWV224LLttHGuxgeu6dluo9ebuUUIoFT8hEAeU4Uy#n#qwwiNqzooGUbWgp2rLcxSZUEkNPzTmYcw1GlSMyXXCJhuNTmyO9tN5hdz9nI/3PQ#n#xBI8kBDKKYMMNn1KtRqlWQ==#ZWqr/funAgzcemNtAG1z+pLXphzOFiQM9PSAc6oDrXiawICQ0dvFj5nKqoeNNYAG#n#ti3wGAlKQ1i2iqe2dVfnTKRsPdKKnFJbShgoz4Z0s5N8iVH0Ig/aa0z0CJPA5OzC#n#Hco7+LmDLgLER+21EfEsdK1eWg+yxZg1PRvXruHxnO96Gq4fxIZNPIJnoSUzMbEH#n#+f3ZvdQ890fo2GSR4HDDPy0aQgBxp6GNHhDwiaer7hFp7GLwwEq1H3LkWHThTtiv#n#s2Ug+clhWIp2u8fmooHjNKRK/3IcUjkFbnY1hwbQ1nbcfLO10sFaPfN1I7JBuTxR#n#s7hjtVD4Gpb8iv9HCGonzg==#cPZ8/eIi4++oG4ZLj0/tuO0xZgjTy9Vi6nm/0HKQvjFzXfngcyU/aU5GDKwSl3DH#n#7UTXCmaterJjMxidefNUVaZkqVoP7hrTH7sxZVvnOZZyvHue2P+pdv1jWrCZx9ry#n#FUFz8bsC6VHhj5uWviX0yBVOCr8Vr0La6y4O4NE+zENTqKLdB+eYpMrliTgj3FX2#n#ffyLuDtRnpqEIVbSGJDa9uJXMCieB+QN/gKC7GXGZNkbrRU8pRfGbyvnzAzlHLAo#n#ehY8cxjxE//tmAcpjPoFzJgMTMqpxBwIaCvQljWZsXZq+VP9EIUJVnc9W4wl3K9t#n#X6CpWtRXyCPzSUreoZF4DA==#ENg8sH42gHyMELsTRK0SWQIdsjNyxLtWUF7jtx0xAzjmGonRJjWCV81loejju7Xm#n#oIn01avDt6FqBdbT3kWtQGVRGVL6UL8nZpB+h8M527RBBsmsKcY92NIbF/tZ3YUf#n#noQn/fVT25eKt+0dS15q8p7o4zKnANBy24uktYzl5B//aS589SvkpUcl74N0imnZ#n#kyDkGSwgv4gu/8BgVU6ad5/socwFSKP56NJTiKPqJAqAHAXW24I3pNoD7wz6T/1G#n#AEY8yeteeqpqc1EtmS6XANKhpQT6C9No4+ydyQVbvUMjoNFJIj1nrw3LTfkwxKX4#n#yc48tTBx1KQTvVzWaSm0tg==#,prIuVEjY/ZgHq/R5k149fl/5sOg2d9zaq/5LMlmAmRA6Z3xBKRqtEfYsEp//+4nTLqbDrZ2GQ0zZLEUoEX1dTZ/xcf4LElCLlwN5VfQHZ5mlWI9Ppn6B952Ge5OY/XS5gZ7wXCrBjfx2taw7KPWbvw+dJSiFACBFAdO5/CtVjAVoLVNR6aukXCmamHeamJMixY+OkYEXA4wGpv75Ni1YwE7kswhx+6/GS7X/rGR1KIkzob8sQEGK4fKZKlFddMaGT1lGlvlAWxpXkJxUeIRfraq+HkFfJSCUG16YyyPl89ExEyHKB85mIPestp6i2iekhZZbdOOoRvrIbjU5VDhiWg==,56e0af43-11c5-499c-ab1b-80aea591a9cd,parlamentary,1375768567129,-----BEGIN CERTIFICATE-----#r##n#MIIDcjCCAlqgAwIBAgIFAIlL9yswDQYJKoZIhvcNAQEFBQAwWjENMAsGA1UECgwE#r##n#U3RhdDELMAkGA1UEBhMCTk8xDzANBgNVBAMMBjczMDA3MTErMCkGA1UECwwiS29t#r##n#bXVuYWwtIG9nIHJlZ2lvbmFsZGVwYXJ0ZW1lbnRldDAeFw0xMjA4MDYwNTMxMDJa#r##n#Fw0yNTA4MDYwNTMxMDJaMIGJMQwwCgYDVQQKDANPcmcxDjAMBgNVBAgMBVN0YXRl#r##n#MRAwDgYDVQQGEwdDb3VudHJ5MUgwRgYDVQQDDD9Wb3Rlcl8xWXpMQ2RxcmxySGIz#r##n#T3BuQ1RNbkxraGhrcWtORUxQNGlMa0xRcTNmOW1FPV9TaWduX183MzAwNzExDTAL#r##n#BgNVBAsMBFVuaXQwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC++o00#r##n#70U9EqFB5ISFDaCpIp33h5Lild7CbfHGd2eXZqF29a3LTDZJ0xcj6ML6uJHfAGHb#r##n#+Wp3HBj1bkk77VbQ56DB82ntz88neMrKKiZA3WIB/TgVD0U71Djh6czsd2q+UxgW#r##n#U/6TAHAMpXurb7pxw6AIHGrRnLPOGBNIcTikqqux0+IMpPDWEv6gK99CWN2GtvO+#r##n#Ds8oxPsGx3qIpKLkGq4ozBNaFE10kqLoO/WzIeETknzQy5YvF9v3Tu/BJufcI9LS#r##n#+XqczDX0G5HPJHWap9rB/YL/2Wa79HLP6I84LaF0VI+5rtKs5mOwXuSoVKBoSG9k#r##n#QmFSuQWd9JOYONrzAgMBAAGjDzANMAsGA1UdDwQEAwIGwDANBgkqhkiG9w0BAQUF#r##n#AAOCAQEAQ7ntcMb0kZZOk49M5rEgRtsac1u/upj6/xsS9aWFz/iZsHaPQKnnUFV2#r##n#e1Q4FnsGDfSXefLJDWyqOaObrMJ6c2pa8W09RVRcrUibkeLmUxC1PmifD3Gsr3jV#r##n#xnk+xMrGsjrjfHR3mCZ934Pboy3g4Wwz8heRwUA1mahRW6FO1QfGrDE2NcWXVM8V#r##n#FnY9RVYhoQkYqV2s34YhCD7WsmnK3dDnz3DI9w50LcWmf4oqGHbcqcO9LOPodF+O#r##n#BcprDKV5dPumapHKhKrXXJn6zcI8uESoFb0DtAN4LClJtsy2qDzOIrM8Ye4yOGMS#r##n#3x9u80KJrjmw0Skc/L6CWzGDOWyQOw==#r##n#-----END CERTIFICATE-----,730071.47.18.1824.182400.0005" +
        COMMA + GIVEN_CONTEST_ID + COMMA + GIVEN_ELECTION_ID + COMMA +
        GIVEN_ELECTION_EVENT_ID + COMMA +
        "01024132990,CHANNEL_ID_UNCONTROLLED,1375768580765,NTc5OTI3ODI5Mzk3MjY3Mzg2NDg5MTMxMDA5MTc1MDA5MzY3MjA5NTkzNDg5NTU2NTEzODc0MzY5MzI3OTkxNzU2MDEzNjU4MjU4NTZ8NTM1OTAwNTIwNDA4NjY4MzUyNjQyNjM2Mzc5ODAyMjMxNDEwMjQ3NDc3NzAyMDgwNzk1NjM3ODUwMTI3NTUzOTE5NjA1MDYyOTExODgzMDg4NDI2NDU0NDE4ODcyODQ3NTE3NjUzMzMwNDQ2OTcxMjc1ODAyNTc3MDc3NTA2MzQ5NjExNzA5Nzg4MDU1OTYxNzA5MzE0NzA1Mjk0NjAwMzY2MzI1MDcwMzE1OTkxNjcwODExODI3NjI1NjUyNzI5NzUzNDQ4MTA2ODMyMjkwMDk4ODM1OTQ4NjgyMTgxOTk0ODUwNzc2NzA1MDY3MjUzOTA2MzUzNjQ0MjAyNzEwOTMyMjUwODY0MTg5MTQyOTI4ODEzMjMxNTQ5MzUwMDM5ODU4ODkxMjU2NjQ2MjE5ODUzNDI0MDAwMjQ5NjUyNTAwOTI4MDY1NzE2MDQ2MjkxNjM0MjY5NzUwMzI5NjgxNzI3Mzc5Mzk5MjYyMjIyNzc2ODg4MjQxNDA5ODIwMDc1MjE3MzE4ODk0NjQyNzg2NDI3NjYwNzU0NjE3OTQ5NTk3NDIzNjA2MjkzNzQyMTI2MzAyODk5MjU4MDA4NjYwNzg2NTcwOTcxNzI1NzIxMDkxMDM5Mzg2MTkwMzk4NjkxOTM0MDMzNzQzODY0NzI1MDY0Nzc5NDM4NTQ5NzMwMTMzOTQxNzE5NTA0MzU2OTgzMTA4NjA5MjEyMzE3NDY0MTEyOTg0NTM2OTcxNDAzODEyMDI1MTk5OTE5NTI3MDQ0Mzk5NTY0MTMzNjI2NTIyOTAyMzM5ODgxMDkwOTA0NTQ1OTE4NDQ2NHxudWxs";
    private static final Object GIVEN_ENC_VOTING_OPTIONS_IDS = new ElGamalEncryptionTuple(new BigInteger(
                "4219031415120855299942504609686631508290959320082397563069424347828916858427890856804159869193969738669364902144363667993754123605745479140673522931091212991868010400778700170829169844186079917454816202448097013888829290929357047271541271300260054320629768553832607161189089093126196236969360986424252073774976859587371724874768871674629200817670760178957172117709698131055872791376164476829523067892192641990382538990769608470540203067181942701960800123042080732484330823445578783104296366077149809354572355812192468635653478783331586884185753771092523075420358478895917905520399779149422153854594596456827646412657"),
            Arrays.asList(
                new BigInteger(
                    "873567894212945473245851061982601130633918138460063736887576845760577045902330906645692566406329817964459809231544531128769651812100561227441194402775556367474981885669880494832149762772423942143597032423816862095987331317433776766813237656500407121322838234440159624060327345323967947959039901388509495803216850022580770727025297153395306553565671762623234396448696075746376157513745500335985426593784153351439821007442908818283929424392926067555466747845804107181470673863367254306353031619592217534965063413169110799537345503604105668981787251995282575750555652467335602774188276721236514633379525523679199106247"),
                new BigInteger(
                    "16884998087899023343760578455016468239162471934362712076078986153713488371121869563938241944716029754447720561138247122385229202543418931532530087932418145070540059160189869825363407525587563298312605496505205642342242783036958204553889456685607893142054199790012122592119583013439972586148269005301349618060961485123714201234421269780155613434314033468883494650529247824661759730556694019384258706020374187944136960998423586563631041420360030195972184436065882701440965663631222418155718437415133910402592347425060590570861088911670342442406197747551411830512985418828214787034911593593009708341807502515219058640654"),
                new BigInteger(
                    "8671946776475622096607783807948274928772715565408542855976497980169305203374031627690512711130012691134648266187776707422189145410155502270819295423891738785208009721915851326740725449312024811126092802988129521303180666656558417530956140945734820874676911636365283493200723724136561725309775262336948736271264327225173266688366470236824366988762834850033870513465477746879957126463049712745963225332520964139343543564036868427138847831540771911900912094208118685869151900037968678415055602074914644457141130366215050784710183057322201082558741508376340533112289887892367478782864151190085186255211914137448015807643"),
                new BigInteger(
                    "16463890616299932289706866306845698316279528281028641548636008353594715277482180811521374395827721022608182461295207540299882190796539483201282665752946292058042536463315553935851881340473694462031632226858482705715991917155305869219388136542347378690711701134799682878287926638474834208305924649618149595576560628644671278232249303096964648916249744308344530886397546004529240117189948989992542343257857004541393265983709350217109503471135425134817867837734196122045437800706933366803398356238350655720256685462934113371437503805261143082435517351320709018944418871463113407362642247826552996798014910271716690861309"),
                new BigInteger(
                    "8234962862190309461541430528783076438391095757135468671160797086166080075597155617109235068601124265185502003559304527505972311643538386813576974175796867895834227997616085466049695430626073347330413740241687166570460626193613903961640972562684389835927532602175183859908190995040468337716651306489293959730894895165382567673996850847116958487806367932704419592710839794189242045451551390794559796274708111819214114203392025277378687545164493945271974249333463835091068876547093763690652835026840126756552083402473194745202037102760738306196926993857734827851545374125329917480308024322145190131958482864572845672635"),
                new BigInteger(
                    "11680523501473885000103261362810918820413104480030516826664200645732513028968450212261748565222264182269799644973862220793166528436144994319221506077466087460130885587264990298371135933660029200163110853655915247190741553266549674231203214309310470578933042379698225465681548263751678709423797436488594766934127934770240937547819382920846892274925444400308613730011052097633795151632428875401401579360531604023550443816926723289210401996355354865088432431757529206241742702677316514051361566047944943388959240674262897282163188661543683489412309038190279736274195365249878733423597911302988836536601660712062923786851"),
                new BigInteger(
                    "10667270043321898774179498664425787785298084980725945284244219736161642186199861670689929503421610226422471132515366347234611808661398934816548686308143216392195804058864259357783039891103191583332492936065920323319308648870695128967056909443429936576175706510174137790391575963095391498039804180583700794136184993665223020262331311548659037640735270234477704750852165179539691105930238516443097999342864812788771789361946590740603107007534070644842528148571306757721443390279108443989775280490939363805797545531114465474355696036456466896167693060267548031756346630913964406258355228208429760303220632365513719624267"),
                new BigInteger(
                    "18485099664259322953019515423682261463465281040703067844643792733687908578232836242509173228397105791526898106744281675548766905758193278199532730678299167994513287941362322251461571196584268120821505125921255451475446397251380003763800962676291841003482929318249976622737543155208426178490999989372376575024047184564620465134715933126362807493571401542487119304607889108590826052835041293877815655939764858938267683869355093191636607910433538126004022180039827947770068485083018997943571713959547967543823532249548944325523454892260516670812056113378122049775785797314695710610550513401626757838468139100032997918372"),
                new BigInteger(
                    "22375527964912345105068723427779484222576889319509786414842312555246594038208651684865939552360663703393501482987552318630423780940550812196699642219922173566197997812567630648085517132832772145800147568547129025782951493003817162706275445861852171027372070770380703603299434933715070094352217826273662730689118833893886089294703532018969252256468602422133391629304363492954654885183891357435539655956320209853352453943295004855957282127380969473246360838427818030084500346499647278931633534132501683173496821572772569704151559017453805087987805162667222201188786775296236604574595604991278275940140233895736982522852"),
                new BigInteger(
                    "11404328125899213808029969578109756251637868991820698353052348991771502256215916506019036375643448208893842688191010816055729186213964227174997105129137790883964562545203744340243241568071281624599906217414420311277547165534972456386461536860742313011674425968615480008128461907328570042327139486011445859210579330716643639653875886494287903512409963937413933646633246381285121674910668579479401644850214501328607910541333493057449976345168844678125797676970073396437063282893469538283803685205376663468696005101134746467254994221904549150958451666769013673347555181232891219338975603553496404486452431518939760353137"),
                new BigInteger(
                    "21254040050939420780710182557167421045392794581130987099901438627780139688585223285392403835583226032143782396766364884692171665196700509767803013813116763348203124377213607681826693290820868467199027561962021991106876539945048797162859269649028503312412430944326960359641902423898839624037970183233272702760399598668361908294088630190190866572816689401926597427897371518307199738463675310831301444289339554169867127644921698657360419384318955505867379256811367357168888598628062444355115823066328452802043113251403524132741394637684249816793656559188056090632362088724113047282699750164285159512390925944482384752367"),
                new BigInteger(
                    "9646135670151213913889946040525730770380307958665328922133980302756534091814700655928664076278756224728693924456468594904947148592768860337436990630113511919697511215799501144631697326178668194121884848684835820701171557763074978433823752074810334670241598911545551303050138700670927871432358578977206988145438957606681324487649817055497683917909804520207933390450501845722334827466441169420931173784613164459378954840793219223500770650314158415225430961304796953439764207531780218153689844204113893065580098324808949004940594457110928277819366321268825890099768014224810416130131650926667364493827386273168034014553"),
                new BigInteger(
                    "12802670648456103378594416895383362277651067118647606842121686181488424684072843359302380356176866236128253835058836131911287164044423963131776799191073454440804606010388203969652463373806319258247220559547862819557904710233013465888901251195165940378056928474250606412780928433599463130532773176940315443474324323843589597137465261678128998126246396752981454268503750000436593665358427423320412314860755136591140991019012560734430889233026192107263989047217243566962555866314273384530780760260779527327554373206814379670915251063842628067717132246972001828216969186016096746397488445805499497250871521214425067038670"),
                new BigInteger(
                    "14260238041908736078793843046775254837440764444942982602012960911896521544216845650688179470365045577047246221435218183360992332981259767094923761156936375254372125752179638288576952625934562654124085060350385937555836154406327912417295474478504750459825107797553312865352545704632537351784307887684737855037314682103189028758311888185129616826219458335096456162428997255221226124953567388364889208940285478203370481032152244797910536354162572119567204150860784926583239711559068503781129775964916820416282332696714998904762962843060776784934779151483586572720187327214445036081531489825614525464002105824394785945612"),
                new BigInteger(
                    "2126443351894264018765437460135775669188932904198927913874414560439495933878958771796132753558615353530596239612896409410104282176000692149387926212954598182548322834164550091838030663781771102717576202740886666048865337589401231656327452538390079939713672618470382145475504111867559194815250382176920790357186940896674201953048678535595632299896446899286888216683272870690557130872636696934689997683282665397656198057651976686461373839062253628486612810414658366847416347026427620343345193533284377921808912791488846499705152179632132853519777352139271525832549246089349846987405390293495497323705793599099468625078")));
    private EncryptedVote encryptedVote;

    /**
     * Creates an encrypted vote to run the tests against.
     */
    @BeforeMethod
    public void createEncryptedVote() {
        encryptedVote = new EncryptedVote(GIVEN_SAMPLE_LINE);
    }

    /**
     * Verifies that the constructor sets the UUID correctly from
     * a line.
     */
    @Test
    public void constructorMustSetTheUuidCorrectly() {
        assertEquals(encryptedVote.getUuid(), GIVEN_UUID);
    }

    /**
     * Verifies that the voter area ID is set correctly from a line.
     */
    @Test
    public void constructorMustSetTheVoterAreaIdCorrectly() {
        assertEquals(encryptedVote.getVoterAreaId(), VOTER_AREA_ID);
    }

    /**
     * Verifies that the constructor sets the contest ID correctly from
     * a line.
     */
    @Test
    public void constructorMustSetTheContestIdCorrectly() {
        assertEquals(encryptedVote.getContestId(), GIVEN_CONTEST_ID);
    }

    /**
     * Verifies that the constructor sets the election ID correctly from
     * a line.
     */
    @Test
    public void constructorMustSetTheElectionIdCorrectly() {
        assertEquals(encryptedVote.getElectionId(), GIVEN_ELECTION_ID);
    }

    /**
     * Verifies that the constructor sets the election event ID correctly from
     * a line.
     */
    @Test
    public void constructorMustSetTheElectionEventIdCorrectly() {
        assertEquals(encryptedVote.getElectionEventId(), GIVEN_ELECTION_EVENT_ID);
    }

    /**
     * Verifies that the constructor sets the encoded voting option IDs correctly.
     */
    @Test
    public void constructorMustSetTheEncVotingOptionIdsCorrectly() {
        assertEquals(encryptedVote.getEncVoteOptIds(),
            GIVEN_ENC_VOTING_OPTIONS_IDS);
    }

    /**
     * Verifies that an IllegalArgumentException is thrown when the authentication token is broken.
     */
    @Test(expectedExceptions = IllegalArgumentException.class)
    public void mustThrowIllegalArgumentExceptionWhenAuthenticationTokenIsBroken() {
        new EncryptedVote(GIVEN_SAMPLE_LINE_WITH_BROKEN_AUTH_TOKEN);
    }

    /**
     * Verifies that no IllegalArgumentException is thrown when a reduced encrypted vote is constructed.
     */
    @Test
    public void mustNotThrowIllegalArgumentForAReducedEncryptedVote() {
        assertNotNull(new EncryptedVote(GIVEN_REDUCED_SAMPLE_LINE));
    }

    /**
     * Verifies that the Base64 encoding is done correctly. The example is taken
     * from Wikipedia.
     *
     * @throws UnsupportedEncodingException Encoding set to UTF-8, and should
     * therefore not be thrown.
     */
    @Test
    public void mustEncodeBase64() throws UnsupportedEncodingException {
        assertEquals(EncryptedVote.encodeBase64(
                "Man is distinguished, not only by his reason, but by this singular passion from other animals, which is a lust of the mind, that by a perseverance of delight in the continued and indefatigable generation of knowledge, exceeds the short vehemence of any carnal pleasure.".getBytes(
                    EncryptedVote.UTF_8)),
            "TWFuIGlzIGRpc3Rpbmd1aXNoZWQsIG5vdCBvbmx5IGJ5IGhpcyByZWFzb24sIGJ1dCBieSB0aGlzIHNpbmd1bGFyIHBhc3Npb24gZnJvbSBvdGhlciBhbmltYWxzLCB3aGljaCBpcyBhIGx1c3Qgb2YgdGhlIG1pbmQsIHRoYXQgYnkgYSBwZXJzZXZlcmFuY2Ugb2YgZGVsaWdodCBpbiB0aGUgY29udGludWVkIGFuZCBpbmRlZmF0aWdhYmxlIGdlbmVyYXRpb24gb2Yga25vd2xlZGdlLCBleGNlZWRzIHRoZSBzaG9ydCB2ZWhlbWVuY2Ugb2YgYW55IGNhcm5hbCBwbGVhc3VyZS4=");
    }

    /**
     * Verifies that digesting is done correctly. The example is taken from
     * Wikipedia.
     *
     * @throws UnsupportedEncodingException Encoding set to UTF-8, and should
     * therefore not be thrown.
     * @throws NoSuchAlgorithmException Algorithm set to version that should be
     * provided, and should therefore never be thrown.
     */
    @Test
    public void mustDigestCorrectly()
        throws UnsupportedEncodingException, NoSuchAlgorithmException {
        byte[] actual = EncryptedVote.hash("".getBytes(EncryptedVote.UTF_8));
        assertEquals(actual, EXPECTED_SHA_256);
    }

    /**
     * Verifies that the voting receipt is calculated correctly on an encrypted
     * vote.
     *
     * @throws NoSuchAlgorithmException Algorithm set to version that should be
     * provided, and should therefore never be thrown.
     * @throws ClassNotFoundException Sample line should be in line with provided
     * version of AuthToken, and should therefore never be thrown.
     * @throws IOException Sample line should be fine to read from, and should
     * therefore never be thrown.
     */
    @Test
    public void mustCalculateVotingReceiptCorrectly()
        throws NoSuchAlgorithmException, IOException, ClassNotFoundException {
        assertEquals(encryptedVote.getVotingReceipt(), GIVEN_VOTING_RECEIPT);
    }
}
